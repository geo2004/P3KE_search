<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h1>Search by NIK</h1>
    <input type="text" id="nikInput" placeholder="Enter NIK">
    <button onclick="searchRecord()">Search</button>

    <div id="results"></div>

    <script>
      function searchRecord() {
        var nik = document.getElementById('nikInput').value;
        var url = 'https://script.google.com/macros/s/AKfycbys7qlMEtClz0vTUQgFcj_ZvmLuaUApoVR_0hUMA-so6WV82_Sbp9Vfavs5gp2-VaVa5A/exec?nik=' + nik;

        // Create a script element and set the URL with callback function
        var script = document.createElement('script');
        script.src = url + '&callback=displayResults';
        document.body.appendChild(script);
      }

      function displayResults(results) {
        var outputDiv = document.getElementById('results');
        outputDiv.innerHTML = '';

        if (results.length === 0) {
          outputDiv.innerHTML = 'No records found for the given NIK.';
          return;
        }

        var table = '<table border="1"><tr><th>NO</th><th>ID_P3KE</th><th>NO_KK</th><th>NIK</th><th>KEPALA_RUTA</th><th>ALAMAT</th><th>KALURAHAN</th><th>KAPANEWON</th><th>DESIL</th><th>KETERANGAN</th></tr>';

        for (var i = 0; i < results.length; i++) {
          table += '<tr>';
          for (var j = 0; j < results[i].length; j++) {
            table += '<td>' + results[i][j] + '</td>';
          }
          table += '</tr>';
        }

        table += '</table>';
        outputDiv.innerHTML = table;
      }
    </script>
  </body>
</html>
