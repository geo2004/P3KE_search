<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h1>Search by NIK</h1>
    <input type="text" id="nikInput" placeholder="Enter NIK">
    <button onclick="searchRecord()">Search</button>

    <div id="results"></div>

<script>
  function searchRecord() {
    var nik = document.getElementById('nikInput').value;
    var url = 'https://script.google.com/macros/s/AKfycbxUdYFq4oC_IU04zZridlJsV2e6E5QT1EM6C3OZ_59Hj0XHbLxhOVr0mNQ58sqErosViw/exec?nik=' + nik + '&callback=displayResults';
    var script = document.createElement('script');
    script.src = url;
    document.body.appendChild(script);
  }

      function displayResults(results) {
        var outputDiv = document.getElementById('results');
        outputDiv.innerHTML = '';

        if (results.length === 0) {
          outputDiv.innerHTML = 'No records found for the given NIK.';
          return;
        }

        var table = '<table border="1"><tr><th>NO</th><th>ID_P3KE</th><th>NO_KK</th><th>NIK</th><th>KEPALA_RUTA</th><th>ALAMAT</th><th>KALURAHAN</th><th>KAPANEWON</th><th>DESIL</th><th>KETERANGAN</th></tr>';

        for (var i = 0; i < results.length; i++) {
          table += '<tr>';
          for (var j = 0; j < results[i].length; j++) {
            table += '<td>' + results[i][j] + '</td>';
          }
          table += '</tr>';
        }

        table += '</table>';
        outputDiv.innerHTML = table;
      }
    </script>
  </body>
</html>
